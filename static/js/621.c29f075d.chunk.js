"use strict";(self.webpackChunkpoker=self.webpackChunkpoker||[]).push([[621],{4621:function(e,s,n){n.r(s),n.d(s,{default:function(){return g}});var t=n(4165),a=n(4942),i=n(1413),r=n(5861),c=n(1037),o=n(8391),u=n(2159),l=n(4728),d=n(2343),m=n(3712),g=function(e){var s=e.messagesList,n=(e.messagesLastUpdates,e.messagesInfo),g=e.id,Z=e.uuid,f=e.ongoingGame,p=e.playersList,_=e.playerDataArr,h=e.open,x=(0,o.useState)(""),j=(0,c.Z)(x,2),k=j[0],w=j[1],b=_.reduce((function(e,s){return f&&!p.includes(s.uid)||(e[s.uid]=s),e}),{}),v=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===k){e.next=4;break}return e.next=3,(0,u.r7)((0,u.JU)(l.db,"game_rooms_poker/".concat(g)),{messages_list:(0,u.vr)({message:k,uid:Z}),messages_last_updates:u.EK.now(),messages_info:Object.keys(n).includes(Z)?(0,i.Z)((0,i.Z)({},n),{},(0,a.Z)({},Z,(0,i.Z)((0,i.Z)({},n[Z]),{},{lastView:u.EK.now()}))):(0,i.Z)((0,i.Z)({},n),{},(0,a.Z)({},Z,{lastView:u.EK.now()}))});case 3:w("");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){(0,u.r7)((0,u.JU)(l.db,"game_rooms_poker/".concat(g)),{messages_info:Object.keys(n).includes(Z)?(0,i.Z)((0,i.Z)({},n),{},(0,a.Z)({},Z,(0,i.Z)((0,i.Z)({},n[Z]),{},{uid:Z,lastView:u.EK.now()}))):(0,i.Z)((0,i.Z)({},n),{},(0,a.Z)({},Z,{uid:Z,lastView:u.EK.now()}))})};return(0,o.useEffect)((function(){return h&&N(),function(){h&&N()}}),[h]),(0,m.jsxs)("div",{className:"menu_messages_block",children:[(0,m.jsx)("h4",{children:"Chat"}),(0,m.jsx)("div",{className:"custom_scrollbar",children:s.map((function(e,s){return(0,m.jsxs)("div",{className:"message_item ".concat(e.uid===Z?"current":""),children:[(0,m.jsx)("img",{src:d.Z[b[e.uid].icon_index],alt:"",width:"64px",height:"64px"}),(0,m.jsxs)("div",{className:"message_block",children:[(0,m.jsx)("div",{className:"message_title",children:b[e.uid].username}),(0,m.jsx)("div",{className:"message_text",children:e.message})]})]},"message_".concat(s))}))}),0===s.length&&(0,m.jsx)("div",{className:"empty_state",children:(0,m.jsx)("p",{children:"Nothing Here"})}),(0,m.jsx)("p",{className:"write_players",children:Object.values(n).filter((function(e){return e.isWriting&&e.uid!==Z})).map((function(e){return b[e.uid].username})).join(", ")}),(0,m.jsx)("textarea",{id:"story",name:"story",rows:"3",placeholder:"Message",value:k,onChange:function(e){return w(e.target.value)},onFocus:function(){(0,u.r7)((0,u.JU)(l.db,"game_rooms_poker/".concat(g)),{messages_info:(0,i.Z)((0,i.Z)({},n),{},(0,a.Z)({},Z,(0,i.Z)((0,i.Z)({},n[Z]),{},{isWriting:!0})))})},onBlur:function(){(0,u.r7)((0,u.JU)(l.db,"game_rooms_poker/".concat(g)),{messages_info:(0,i.Z)((0,i.Z)({},n),{},(0,a.Z)({},Z,(0,i.Z)((0,i.Z)({},n[Z]),{},{isWriting:!1})))})}}),(0,m.jsx)("button",{onClick:v,className:"send_btn",children:"Send"})]})}}}]);