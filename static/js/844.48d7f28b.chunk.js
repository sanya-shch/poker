"use strict";(self.webpackChunkpoker=self.webpackChunkpoker||[]).push([[844],{4844:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var i=n(2982),a=n(4165),r=n(4942),s=n(1413),l=n(5861),o=n(1037),c=n(8391),u=n(2159),d=n(4728),m=n(2603),v=n(7762),h=n(5671),p=n(3144),f=function(){function e(t,n,i){(0,h.Z)(this,e),this.el=document.querySelector(t),this.step=n,this.addedMax=i,this.srValue=null,this.fill=null,this.digitCols=null,this.lastDigits="",this.rollDuration=0,this.trans09=!1,this.el&&(this.buildSlider(),this.el.addEventListener("input",this.changeValue.bind(this)))}return(0,p.Z)(e,[{key:"buildSlider",value:function(){var e=document.createElement("div");e.className="range",this.el.parentElement.insertBefore(e,this.el);var t=document.createElement("span");t.className="range__input",e.appendChild(t);var n=document.createElement("span");n.className="range__input-fill",t.appendChild(this.el),t.appendChild(n);var i=document.createElement("span");i.className="range__counter",e.appendChild(i);var a=document.createElement("span");a.className="range__counter-sr",a.textContent="0",i.appendChild(a);var r,s=(0,v.Z)(this.el.max.split(""));try{for(s.s();!(r=s.n()).done;){r.value;var l=document.createElement("span");l.className="range__counter-column",l.setAttribute("aria-hidden","true"),i.appendChild(l);for(var o=0;o<=11;++o){var c=document.createElement("span");c.className="range__counter-digit",o>0&&(c.textContent=11==o?0:"".concat(o-1)),l.appendChild(c)}}}catch(h){s.e(h)}finally{s.f()}for(this.srValue=a,this.fill=n,this.digitCols=i.querySelectorAll(".range__counter-column"),this.lastDigits=this.el.value;this.lastDigits.length<this.digitCols.length;)this.lastDigits=" "+this.lastDigits;this.changeValue();var u=window.getComputedStyle(this.digitCols[0]).getPropertyValue("transition-duration"),d=u.indexOf("ms"),m=u.indexOf("s");d>-1?this.rollDuration=u.substr(0,d):m>-1&&(this.rollDuration=1e3*u.substr(0,m))}},{key:"changeValue",value:function(){var e=this;if(+this.el.value>+this.el.max?this.el.value=this.el.max:+this.el.value<this.el.min&&(this.el.value=this.el.min),this.srValue&&(this.srValue.textContent=this.el.value),this.fill){var t=this.el.value/this.el.max,n=100*t,i=1-t;this.fill.style.width="calc(".concat(n,"% + ").concat(i,"em)")}if(this.digitCols){for(var a=+this.el.value===+this.el.max?String(+this.el.value-this.addedMax):this.el.value;a.length<this.digitCols.length;)a=" "+a;var r=[];this.lastDigits&&a.split("").forEach((function(t,n){var i=+t-e.lastDigits[n];r.push(i)})),this.trans09=!1,a.split("").forEach((function(t,n){var i=!1,a=!1,s=" "===t?0:-1.5*(+t+1),l=e.digitCols[n];0==t&&-9==r[n]?(s=-16.5,i=!0):9==t&&9==r[n]&&(s=0,a=!0),l.style.transform="translateY(".concat(s,"em)"),l.firstChild.textContent="",(i||a)&&(e.trans09=!0,a&&(l.firstChild.textContent=t),setTimeout((function(){if(e.trans09){var t="range__counter-column--pause",n=-1.5*(i?1:10);l.classList.add(t),l.style.transform="translateY(".concat(n,"em)"),l.offsetHeight,l.classList.remove(t),a&&(l.firstChild.textContent="")}}),e.rollDuration))})),this.lastDigits=a}}},{key:"moveSlider",value:function(e){var t=this;if(this.fill){this.el.value=e.wheelDelta>0?Number(this.el.value)+this.step<Number(this.el.max)?Number(this.el.value)+this.step:Number(this.el.max):Number(this.el.value)-this.step>=Number(this.el.min)?Number(this.el.value)-this.step:Number(this.el.min);var n=this.el.value/this.el.max,i=100*n,a=1-n;this.fill.style.width="calc(".concat(i,"% + ").concat(a,"em)")}if(this.digitCols){for(var r=+this.el.value===+this.el.max?String(+this.el.value-this.addedMax):this.el.value;r.length<this.digitCols.length;)r=" "+r;var s=[];this.lastDigits&&r.split("").forEach((function(e,n){var i=+e-t.lastDigits[n];s.push(i)})),this.trans09=!1,r.split("").forEach((function(e,n){var i=!1,a=!1,r=" "===e?0:-1.5*(+e+1),l=t.digitCols[n];0==e&&-9==s[n]?(r=-16.5,i=!0):9==e&&9==s[n]&&(r=0,a=!0),l.style.transform="translateY(".concat(r,"em)"),l.firstChild.textContent="",(i||a)&&(t.trans09=!0,a&&(l.firstChild.textContent=e),setTimeout((function(){if(t.trans09){var e="range__counter-column--pause",n=-1.5*(i?1:10);l.classList.add(e),l.style.transform="translateY(".concat(n,"em)"),l.offsetHeight,l.classList.remove(e),a&&(l.firstChild.textContent="")}}),t.rollDuration))})),this.lastDigits=r}}}]),e}(),g=n(3712),_=function(e){var t=e.value,n=e.setValue,i=e.min,a=void 0===i?"0":i,r=e.max,s=void 0===r?"5000":r,l=e.step,u=e.addedMax,d=void 0===u?0:u,m=c.useState(t),v=(0,o.Z)(m,2),h=v[0],p=v[1];return c.useEffect((function(){new f("#range2",l,d)}),[d]),(0,g.jsx)("form",{children:(0,g.jsx)("input",{id:"range2",name:"range2",type:"range",min:a,max:s+d,value:h,step:l,onChange:function(e){return p(e.target.value)},onPointerUp:function(){return n(h>=s?s:h)}})})},b=n(9277),x=n(434),y=n(7518),A=n(6165),k=n(1938),Z={2:[[0,1,0],[0,0,0,0],[0,0,0],[0,0,0,0],[0,1,0]],3:[[0,1,0],[0,0,0,0],[0,1,0],[0,0,0,0],[0,1,0]],4:[[1,0,1],[0,0,0,0],[0,0,0],[0,0,0,0],[1,0,1]],5:[[1,0,1],[0,0,0,0],[0,1,0],[0,0,0,0],[1,0,1]],6:[[1,0,1],[0,0,0,0],[1,0,1],[0,0,0,0],[1,0,1]],7:[[0,1,0],[1,0,0,1],[0,1,0],[1,0,0,1],[0,1,0]],8:[[0,1,0],[0,1,1,0],[1,0,1],[0,1,1,0],[0,1,0]],9:[[1,1,1],[0,0,0,0],[1,1,1],[0,0,0,0],[1,1,1]],10:[[1,0,1],[0,1,1,0],[1,0,1],[0,1,1,0],[1,0,1]],J:"b",Q:"b",K:"b",A:"b"},j=function(e){var t=e.cardId,n=(0,c.useMemo)((function(){var e;return null===Z||void 0===Z?void 0:Z[null===(e=k.Z[t])||void 0===e?void 0:e.number]}),[t]),i=(0,c.useMemo)((function(){var e;return null===k.Z||void 0===k.Z||null===(e=k.Z[t])||void 0===e?void 0:e.type}),[t]),a=(0,c.useMemo)((function(){var e;return null===k.Z||void 0===k.Z||null===(e=k.Z[t])||void 0===e?void 0:e.number}),[t]);return t?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"card_item desktop_show",children:[(0,g.jsx)("p",{children:a}),"b"===n?(0,g.jsx)("img",{src:A["".concat(i,"Big")],alt:""}):n.map((function(e,t){return(0,g.jsx)("div",{className:"icons_row",children:null===e||void 0===e?void 0:e.map((function(e,t){return(0,g.jsx)("img",{src:A[e?i:"".concat(i,"Gray")],alt:"",width:"32px",height:"32px"},"card-icon-".concat(i,"-").concat(a,"-").concat(t))}))},"card-row-".concat(i,"-").concat(a,"-").concat(t))})),(0,g.jsx)("p",{children:a})]}),(0,g.jsxs)("div",{className:"card_item desktop_hide",children:[(0,g.jsx)("p",{children:a}),(0,g.jsx)("img",{src:A["".concat(i,"Big")],alt:""}),(0,g.jsx)("p",{children:a})]})]}):(0,g.jsx)("div",{className:"empty_card_item"})},C=n(2343),N=function(e){var t=e.gameCards,n=e.bankCount,i=e.playerDataArr,a=e.playersList,r=e.lastActions,s=e.uuid,l=e.playerCards,o=e.currentPlayerUid,c=e.dealerUid,u=a.reduce((function(e,t){return e.push(i.find((function(e){return e.uid===t}))),e}),[]);return(0,g.jsx)("div",{className:"game_board_wrapper",children:(0,g.jsxs)("div",{className:"game_board_container players_".concat(u.length),children:[u.map((function(e,t){var n,i,a,u,d,m,v,h,p,f,_;return(0,g.jsxs)("div",{className:"player_block player_".concat(t+1),children:[(null===(n=r[e.uid])||void 0===n?void 0:n.action)===x.A.fold?(0,g.jsx)("div",{className:"fold_block",children:"FOLD"}):e.uid===s?(0,g.jsxs)("div",{className:"player_cards",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{children:k.Z[l[e.uid][0]].number}),(0,g.jsx)("img",{src:A[k.Z[l[e.uid][0]].type],alt:""})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{children:k.Z[l[e.uid][1]].number}),(0,g.jsx)("img",{src:A[k.Z[l[e.uid][1]].type],alt:""})]})]}):(0,g.jsxs)("div",{className:"hidden_player_cards",children:[(0,g.jsx)("div",{}),(0,g.jsx)("div",{})]}),(0,g.jsxs)("div",{className:["player_info",e.uid===o&&"current_player"].filter(Boolean).join(" "),children:[(0,g.jsxs)("div",{className:"player_text_info",children:[(0,g.jsx)("div",{className:"username_block",children:(0,g.jsx)("p",{children:e.uid===s?(0,g.jsxs)(g.Fragment,{children:["You",(0,g.jsxs)("span",{children:["- ",e.username]})]}):e.username})}),(0,g.jsxs)("div",{className:"money_block",children:[(0,g.jsx)("p",{children:e.money}),e.uid===c&&(0,g.jsx)("div",{className:"dealer_block",children:(0,g.jsx)("p",{children:"D"})})]}),(0,g.jsx)("img",{src:C.Z[e.icon_index],alt:"",width:"52px",height:"52px"})]}),(null===(i=r[e.uid])||void 0===i?void 0:i.action)===x.A.small_blind&&(0,g.jsx)("div",{className:"player_action_block",children:"Small Blind"}),(null===(a=r[e.uid])||void 0===a?void 0:a.action)===x.A.big_blind&&(0,g.jsx)("div",{className:"player_action_block",children:"Big Blind"}),(null===(u=r[e.uid])||void 0===u?void 0:u.action)===x.A.call&&(0,g.jsx)("div",{className:"player_action_block",children:"Call"}),(null===(d=r[e.uid])||void 0===d?void 0:d.action)===x.A.check&&(0,g.jsx)("div",{className:"player_action_block",children:"Check"}),(null===(m=r[e.uid])||void 0===m?void 0:m.action)===x.A.bet&&(0,g.jsxs)("div",{className:"player_action_block",children:["Bet ",null===(v=r[e.uid])||void 0===v?void 0:v.number]}),(null===(h=r[e.uid])||void 0===h?void 0:h.action)===x.A.raise&&(0,g.jsxs)("div",{className:"player_action_block",children:["Raise to ",null===(p=r[e.uid])||void 0===p?void 0:p.number]}),(null===(f=r[e.uid])||void 0===f?void 0:f.action)===x.A.all_in&&(0,g.jsxs)("div",{className:"player_action_block",children:["All in ",null===(_=r[e.uid])||void 0===_?void 0:_.number]})]})]},e.uid)})),(0,g.jsxs)("div",{className:"bank_block",children:[(0,g.jsx)("img",{src:"data:image/png;base64,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",width:"50px",height:"50px",alt:""}),(0,g.jsx)("p",{children:n||0})]}),(0,g.jsxs)("div",{className:"cards",children:[(0,g.jsx)(j,{cardId:t[0]}),(0,g.jsx)(j,{cardId:t[1]}),(0,g.jsx)(j,{cardId:t[2]}),(0,g.jsx)(j,{cardId:t[3]}),(0,g.jsx)(j,{cardId:t[4]})]})]})})},S=(0,c.lazy)((function(){return n.e(490).then(n.bind(n,5490))})),w=function(e){var t,n,v,h,p,f=e.playerDataArr,A=e.playerCards,k=e.cardDeck,Z=e.currentPlayerUid,j=e.playersList,C=e.uuid,w=e.id,D=e.dealerUid,U=e.lastActions,B=e.gameCards,L=e.bankCount,E=e.withBackgroundAnimation,M=e.bigBlind,I=e.gameStage,W=e.isHost,O=e.currentBet,V=void 0===O?0:O,K=e.allInBanks,R=e.setIsFinishModalOpen,H=e.lastStreetBank,T=void 0===H?0:H,F=e.spendMoneyList,P=(0,c.useState)(!1),G=(0,o.Z)(P,2),X=G[0],J=G[1],Y=(0,c.useState)(V+M),z=(0,o.Z)(Y,2),Q=z[0],q=z[1],$=(0,c.useMemo)((function(){var e;return(null===(e=f.find((function(e){return e.uid===C})))||void 0===e?void 0:e.money)||0}),[f,C]),ee=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(){var t,n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(2!==(t=j.filter((function(e){var t;return(null===(t=U[e])||void 0===t?void 0:t.action)!==x.A.fold}))).length){e.next=7;break}return n=t.filter((function(e){return e!==C}))[0],e.next=5,(0,u.r7)((0,u.JU)(d.db,"game_rooms_poker/".concat(w)),{ongoing_game:!1,midgame_player_uid:[],card_deck:[],player_cards:{},players_list:[],last_actions:{},game_stage:y.H.start,game_cards:[],bank:0,current_bet:0,all_in_banks:{},current_player_uid:n,player_data_arr:f.map((function(e){return e.uid===n?(0,s.Z)((0,s.Z)({},e),{},{money:e.money+L,points:e.points+1}):e})),history_list:u.vr.apply(void 0,[{message:x.A.fold,uid:C,gameStage:I},{message:"Winner",uid:n,gameStage:I}])});case 5:e.next=10;break;case 7:return i=(0,b.uU)(t,C),e.next=10,(0,u.r7)((0,u.JU)(d.db,"game_rooms_poker/".concat(w)),{current_player_uid:i,last_actions:(0,s.Z)((0,s.Z)({},U),{},(0,r.Z)({},C,{action:x.A.fold})),history_list:(0,u.vr)({message:x.A.fold,uid:C,gameStage:I})});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=(0,c.useMemo)((function(){var e,t;return((null===(e=U[C])||void 0===e?void 0:e.number)||0)+(null===(t=f.find((function(e){return e.uid===C})))||void 0===t?void 0:t.money)<=V}),[f,C,V]),ne=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(){var t,n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,b.uU)(j.filter((function(e){var t,n;return!((null===(t=U[e])||void 0===t?void 0:t.action)===x.A.fold||(null===(n=U[e])||void 0===n?void 0:n.action)===x.A.all_in)})),C),i=(null===(t=U[C])||void 0===t?void 0:t.number)||0,e.next=4,(0,u.r7)((0,u.JU)(d.db,"game_rooms_poker/".concat(w)),{current_player_uid:n,last_actions:(0,s.Z)((0,s.Z)({},U),{},(0,r.Z)({},C,{action:te?x.A.all_in:0===V?x.A.check:x.A.call,number:te?i+$:V,end:!0})),bank:te?L+$:L+V-i,player_data_arr:f.map((function(e){return e.uid===C?(0,s.Z)((0,s.Z)({},e),{},{money:te?0:e.money+i-V}):e})),all_in_banks:(0,s.Z)((0,s.Z)({},Object.entries(K).reduce((function(e,t){var n=(0,o.Z)(t,2),a=n[0],r=n[1];if(r.gameStage===I){var l=te?F[a].money<i+$?F[a].money:i+$:F[a].money<V?F[a].money:V;e[a]=(0,s.Z)((0,s.Z)({},r),{},{bank:r.bank+l})}else e[a]=r;return e}),{})),te?(0,r.Z)({},C,{bank:T+i+$+Object.keys(F).reduce((function(e,t){return F[t]&&(e+=F[t].money<i+$?F[t].money:i+$),e}),0),gameStage:I}):{}),spend_money:(0,s.Z)((0,s.Z)({},F),{},(0,r.Z)({},C,{money:te?i+$:V})),history_list:(0,u.vr)((0,s.Z)({message:te?x.A.all_in:0===V?x.A.check:x.A.call,uid:C,gameStage:I},te?{number:i+$}:{}))});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(){var t,n,i,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,b.uU)(j.filter((function(e){var t,n;return!((null===(t=U[e])||void 0===t?void 0:t.action)===x.A.fold||(null===(n=U[e])||void 0===n?void 0:n.action)===x.A.all_in)})),C),i=(null===(t=U[C])||void 0===t?void 0:t.number)||0,l=Number($)+i===Number(Q),e.next=5,(0,u.r7)((0,u.JU)(d.db,"game_rooms_poker/".concat(w)),{current_player_uid:n,last_actions:(0,s.Z)((0,s.Z)({},Object.keys(U).reduce((function(e,t){return U[t].action===x.A.fold||U[t].action===x.A.all_in?e[t]=U[t]:e[t]=(0,s.Z)((0,s.Z)({},U[t]),{},{end:!1}),e}),{})),{},(0,r.Z)({},C,{action:l?x.A.all_in:0===V?x.A.bet:x.A.raise,number:Number(Q),end:!0})),current_bet:V>=Number(Q)?V:Number(Q),bank:l?L+$:L+Number(Q)-i,player_data_arr:f.map((function(e){return e.uid===C?(0,s.Z)((0,s.Z)({},e),{},{money:l?0:e.money+i-Number(Q)}):e})),all_in_banks:(0,s.Z)((0,s.Z)({},Object.entries(K).reduce((function(e,t){var n=(0,o.Z)(t,2),a=n[0],r=n[1];if(r.gameStage===I){var c=l?F[a].money<i+$?F[a].money:i+$:F[a].money<Number(Q)?F[a].money:Number(Q);e[a]=(0,s.Z)((0,s.Z)({},r),{},{bank:r.bank+c})}else e[a]=r;return e}),{})),l?(0,r.Z)({},C,{bank:T+i+$+Object.keys(F).reduce((function(e,t){return F[t]&&(e+=F[t].money<i+$?F[t].money:i+$),e}),0),gameStage:I}):{}),spend_money:(0,s.Z)((0,s.Z)({},F),{},(0,r.Z)({},C,{money:l?i+$:Number(Q)})),history_list:(0,u.vr)({message:l?x.A.all_in:0===V?x.A.bet:x.A.raise,number:l?i+$:Number(Q),uid:C,gameStage:I})});case 5:J(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(){var t,n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,b.uU)(j.filter((function(e){var t,n;return!((null===(t=U[e])||void 0===t?void 0:t.action)===x.A.fold||(null===(n=U[e])||void 0===n?void 0:n.action)===x.A.all_in)})),C),i=(null===(t=U[C])||void 0===t?void 0:t.number)||0,e.next=4,(0,u.r7)((0,u.JU)(d.db,"game_rooms_poker/".concat(w)),{current_player_uid:n,last_actions:(0,s.Z)((0,s.Z)({},Object.keys(U).reduce((function(e,t){return U[t].action===x.A.fold||U[t].action===x.A.all_in?e[t]=U[t]:e[t]=(0,s.Z)((0,s.Z)({},U[t]),{},{end:!1}),e}),{})),{},(0,r.Z)({},C,{action:x.A.all_in,number:Number($),end:!0})),current_bet:i+Number($),bank:L+Number($),player_data_arr:f.map((function(e){return e.uid===C?(0,s.Z)((0,s.Z)({},e),{},{money:0}):e})),all_in_banks:(0,s.Z)((0,s.Z)({},Object.entries(K).reduce((function(e,t){var n=(0,o.Z)(t,2),a=n[0],r=n[1];if(r.gameStage===I){var l=F[a].money<i+$?F[a].money:i+$;e[a]=(0,s.Z)((0,s.Z)({},r),{},{bank:r.bank+l})}else e[a]=r;return e}),{})),{},(0,r.Z)({},C,{bank:L+Number($),gameStage:I})),spend_money:(0,s.Z)((0,s.Z)({},F),{},(0,r.Z)({},C,{money:i+$})),history_list:(0,u.vr)({message:x.A.all_in,number:i+Number($),uid:C,gameStage:I})});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=(0,c.useMemo)((function(){return(0,b.tI)({lastActions:U,playersList:j})}),[U,j]),se=(0,c.useCallback)((0,l.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=j.filter((function(e){var t,n;return!((null===(t=U[e])||void 0===t?void 0:t.action)===x.A.fold||(null===(n=U[e])||void 0===n?void 0:n.action)===x.A.all_in)})),n=1===t.length&&U[t[0]].end,r=(0,b.uU)(t,C),e.t0=I,e.next=e.t0===y.H.start?6:e.t0===y.H.flop?9:e.t0===y.H.turn?12:e.t0===y.H.river?15:17;break;case 6:return e.next=8,(0,u.r7)((0,u.JU)(d.db,"game_rooms_poker/".concat(w)),{current_player_uid:r,last_actions:Object.keys(U).reduce((function(e,t){var i,a;return((null===(i=U[t])||void 0===i?void 0:i.action)===x.A.fold||(null===(a=U[t])||void 0===a?void 0:a.action)===x.A.all_in||n)&&(e[t]=U[t]),e}),{}),current_bet:0,game_stage:y.H.flop,game_cards:(0,b.XW)({gameStage:I,cardDeck:k}),history_list:(0,u.vr)({uid:C,cards:(0,b.XW)({gameStage:I,cardDeck:k})}),card_deck:k.slice(4),last_street_bank:L,spend_money:{}});case 8:case 11:case 14:case 17:return e.abrupt("break",18);case 9:return e.next=11,(0,u.r7)((0,u.JU)(d.db,"game_rooms_poker/".concat(w)),{current_player_uid:r,last_actions:Object.keys(U).reduce((function(e,t){var i,a;return((null===(i=U[t])||void 0===i?void 0:i.action)===x.A.fold||(null===(a=U[t])||void 0===a?void 0:a.action)===x.A.all_in||n)&&(e[t]=U[t]),e}),{}),current_bet:0,game_stage:y.H.turn,game_cards:u.vr.apply(void 0,(0,i.Z)((0,b.XW)({gameStage:I,cardDeck:k}))),history_list:(0,u.vr)({uid:C,cards:(0,b.XW)({gameStage:I,cardDeck:k})}),card_deck:k.slice(2),last_street_bank:L,spend_money:{}});case 12:return e.next=14,(0,u.r7)((0,u.JU)(d.db,"game_rooms_poker/".concat(w)),{current_player_uid:r,last_actions:Object.keys(U).reduce((function(e,t){var i,a;return((null===(i=U[t])||void 0===i?void 0:i.action)===x.A.fold||(null===(a=U[t])||void 0===a?void 0:a.action)===x.A.all_in||n)&&(e[t]=U[t]),e}),{}),current_bet:0,game_stage:y.H.river,game_cards:u.vr.apply(void 0,(0,i.Z)((0,b.XW)({gameStage:I,cardDeck:k}))),history_list:(0,u.vr)({uid:C,cards:(0,b.XW)({gameStage:I,cardDeck:k})}),card_deck:k.slice(2),last_street_bank:L,spend_money:{}});case 15:return R(!0),e.abrupt("break",18);case 18:case"end":return e.stop()}}),e)}))),[k,I,w,U,R]),le=(0,c.useMemo)((function(){return(0,b.Kn)({lastActions:U,playersList:j})}),[U,j]);return(0,c.useEffect)((function(){var e;return W?le?e=setTimeout((function(){return se()}),1e3):re&&se():le&&I===y.H.river?e=setTimeout((function(){return R(!0)}),1e3):re&&I===y.H.river&&R(!0),function(){return clearTimeout(e)}}),[I,W,re,se,R]),(0,c.useEffect)((function(){Z===C&&q(V+(M||50))}),[V,M,Z,C]),(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("div",{className:"game_block",children:[(0,g.jsx)(N,{gameCards:B,bankCount:L,playerDataArr:f,playersList:j,lastActions:U,uuid:C,playerCards:A,currentPlayerUid:Z,dealerUid:D}),Z!==C||5===B.length&&(0,b.tI)({lastActions:U,playersList:j})||le||null!==(t=U[C])&&void 0!==t&&t.end?null:X?(0,g.jsxs)("div",{className:"range_block_wrapper",children:[(0,g.jsx)("button",{onClick:function(){J(!1)},children:"Back"}),(0,g.jsx)("div",{className:"range_block",children:(0,g.jsx)(_,{min:V+(M||50),max:((null===(n=U[C])||void 0===n?void 0:n.number)||0)+$,addedMax:M-(((null===(v=U[C])||void 0===v?void 0:v.number)||0)+$)%M,step:M||"50",value:Q,setValue:q})}),(0,g.jsx)("button",{onClick:ie,children:((null===(h=U[C])||void 0===h?void 0:h.number)||0)+$===Number(Q)?"All in":0===V?"Bet":"Raise"})]}):(0,g.jsxs)("div",{className:"game_buttons_block",children:[(0,g.jsx)(m.Z,{text:"Fold",onClick:ee}),(0,g.jsx)(m.Z,{text:0===V?"Check":te?"All in":"Call (".concat(V-((null===(p=U[C])||void 0===p?void 0:p.number)||0),")"),onClick:ne}),!te&&(Number(V)+M===Number($)?(0,g.jsx)(m.Z,{text:"All in",onClick:ae}):(0,g.jsx)(m.Z,{text:0===V?"Bet":"Raise",onClick:function(){J(!0)}}))]}),E&&(0,g.jsx)(c.Suspense,{children:(0,g.jsx)(S,{})})]})})}}}]);